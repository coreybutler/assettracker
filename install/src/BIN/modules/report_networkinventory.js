xrb.rptsys={instructions:"Select the properties and items you wish to include in the report.",propertyFormTitle:"<i><u>System Properties</u></i>",includeFormTitle:"<i><u>Additional Options</u></i>",formAppLabel:"Each Computer's Applications",formNotesLabel:"Each Computer's Administrator Notes",formLocationLabel:"Each Computer's Physical Location",fileName:"adminguide.pdf",fileNameField:"Save As",clearPropertyButton:"Clear",invertPropertyButton:"Invert",allPropertyButton:"Select All",clearOptionButton:"Clear",allOptionButton:"Select All",invertOptionButton:"Invert",data:"./data/report.cfm"};
report_networkinventory=function(e){var d={};var g="";var b=[];var a=new Ext.Panel({iconCls:"icon-user-gray",layout:"fit",closable:false,collapsed:true,collapsible:true,border:false,titleCollapse:true,autoScroll:true,bbar:new Ext.Toolbar({items:[{text:xrb.reportdefault.generate,iconCls:"icon-play",handler:c},{text:xrb.reportdefault.generateSave,iconCls:"icon-folder-go",handler:function(){c(true);
}},"->",{xtype:"tbtext",text:xrb.rptsys.fileNameField+": "},{xtype:"textfield",emptyText:xrb.rptsys.fileName.replace(/\.pdf/g,"")+"_"+Ext.getDateString("Y-m-d-H-i")+".pdf",width:225}]})});Ext.apply(this,{title:this.title,action:this.action,header:false,layout:"fit",border:true,expanded:true,items:[a],listeners:{render:function(){g=this.id;
d=this.initialConfig;if(d.action==undefined||d.action.trim().length==0){d.action=rb.data+"reports/general.cfm";}else{d.action=rb.data+"reports/"+d.action;}}}});report_networkinventory.superclass.constructor.apply(this,arguments);this.on("render",f,this);function f(){loadmask=new Ext.LoadMask(this.getEl(),{msg:rb.defaults.loadmessage});
var h=loadmask;h.show();a.setTitle(d.title+' &raquo; <font class="headerTip">'+xrb.rptsys.instructions+"</font>");Ext.Ajax.request({url:rb.data,params:{get:"properties",user:Ext.getUsername()},success:function(j,q){var p=Ext.decode(j.responseText);var n=110+(p.properties.length*25);n=n>300?300:n<200?200:n;
b=p.properties;var o=new Ext.form.FormPanel({region:"center",header:false,border:false,height:n,autoScroll:true,defaults:{msgTarget:"under",width:165,xtype:"checkbox",hideLabel:true,border:false,header:false},items:[{xtype:"panel",html:xrb.rptsys.propertyFormTitle,height:25}],tbar:new Ext.Toolbar({items:[{text:xrb.rptsys.allPropertyButton,iconCls:"icon-check",handler:function(){a.items.get(0).items.get(0).getForm().reset();
}},{text:xrb.rptsys.clearPropertyButton,iconCls:"icon-remove",handler:function(){var i=a.items.get(0).items.get(0).items;for(m=0;m<i.length;m++){if(i.get(m).getXType()=="checkbox"){i.get(m).setValue(false);}}}},{text:xrb.rptsys.invertPropertyButton,iconCls:"icon-invert",handler:function(){var i=a.items.get(0).items.get(0).items;
for(m=0;m<i.length;m++){if(i.get(m).getXType()=="checkbox"){i.get(m).setValue(!i.get(m).checked);}}}},"->","-"]})});a.setHeight(n+25);for(var m=0;m<b.length;m++){o.add({boxLabel:b[m],checked:true,name:"property",value:b[m]});}var l=new Ext.form.FormPanel({region:"east",header:false,border:true,width:330,autoScroll:true,defaults:{msgTarget:"under",width:280,xtype:"checkbox",hideLabel:true,border:false,header:false,bodyStyle:"color;#555;"},items:[{xtype:"panel",html:xrb.rptsys.includeFormTitle,height:25},{boxLabel:xrb.rptsys.formAppLabel,checked:true,name:"include",inputValue:"applications"},{boxLabel:xrb.rptsys.formNotesLabel,checked:true,name:"include",inputValue:"notes"},{boxLabel:xrb.rptsys.formLocationLabel,checked:true,name:"include",inputValue:"location"}],tbar:new Ext.Toolbar({items:[{text:xrb.rptsys.allOptionButton,iconCls:"icon-check",handler:function(){a.items.get(0).items.get(1).getForm().reset();
}},{text:xrb.rptsys.clearOptionButton,iconCls:"icon-remove",handler:function(){var i=a.items.get(0).items.get(1).items;for(m=0;m<i.length;m++){if(i.get(m).getXType()=="checkbox"){i.get(m).setValue(false);}}}},{text:xrb.rptsys.invertOptionButton,iconCls:"icon-invert",handler:function(){var i=a.items.get(0).items.get(1).items;
for(m=0;m<i.length;m++){if(i.get(m).getXType()=="checkbox"){i.get(m).setValue(!i.get(m).checked);}}}}]})});var k=new Ext.Panel({layout:"border",border:false,defaults:{bodyStyle:Ext.standardBodyStyle,border:false},items:[o,l]});a.add(k);a.doLayout();h.hide();}});}function c(q){var k=a.getBottomToolbar().items;
var t=k.get(k.length-1);var m=a.items.get(0);var h=m.items.get(0).items;var j=m.items.get(1).items;var n=d.action;var r=[];var s=[];n+="?format=pdf";for(var l=0;l<h.length;l++){if(h.get(l).checked){r.push(h.get(l).initialConfig.boxLabel);}}n+="&properties="+r.toString();if(j!=undefined){for(var l=1;l<j.length;
l++){if(j.get(l).checked){s.push(j.get(l).initialConfig.inputValue);}}}n+="&includes="+s.toString();if(t.getValue().trim().length>0){t=t.getValue().trim();}else{t=t.initialConfig.emptyText;}Ext.reporting.executeReport(n,t,q);}};Ext.extend(report_networkinventory,Ext.Panel,{});